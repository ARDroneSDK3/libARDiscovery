LOCAL_PATH := $(call my-dir)

# Not with bionic
ifneq ("$(TARGET_LIBC)","bionic")

include $(CLEAR_VARS)

LOCAL_CATEGORY_PATH := dragon/libs
LOCAL_MODULE := libARDiscovery
LOCAL_DESCRIPTION := ARSDK Discovery and Connection Management Layer

LOCAL_LIBRARIES := libARSAL libARNetwork libARNetworkAL avahi json
LOCAL_EXPORT_LDLIBS := -lardiscovery
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/../Includes

#Autotools variables
LOCAL_AUTOTOOLS_CONFIGURE_ARGS := --with-libARSALInstallDir="" --with-jsonInstallDir="" --with-libARNetworkInstallDir="" --with-libARNetworkALInstallDir=""

LOCAL_AUTOTOOLS_CONFIGURE_ENV := ac_cv_header_avahi_client_client_h=no

ifneq ($(TARGET_PRODUCT),pclinux)
LOCAL_AUTOTOOLS_CONFIGURE_ARGS += --enable-avahi-nodbus
endif

ifeq ("$(TARGET_PBUILD_FORCE_STATIC)","1")
LOCAL_AUTOTOOLS_CONFIGURE_ARGS += --disable-shared
endif


# User define command to be launch before configure step.
# Generates files used by configure
define LOCAL_AUTOTOOLS_CMD_POST_UNPACK
	$(Q) cd $(PRIVATE_SRC_DIR) && ./bootstrap
endef

# User define command to be launch after dirclean
# Remove every files generated by bootstrap
define LOCAL_AUTOTOOLS_CMD_POST_DIRCLEAN
	$(Q) cd $(PRIVATE_SRC_DIR) && ./cleanup
endef

include $(BUILD_AUTOTOOLS)

endif
